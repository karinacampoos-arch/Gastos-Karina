<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Gastos Karina</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="manifest" href="manifest.json">

<style>
:root{
  --bg:#0e0f13;
  --card:#181a20;
  --input:#22252d;
  --text:#f1f1f1;
  --sub:#9aa0a6;
  --green:#25D366;
  --blue:#4f7cff;
  --red:#ff5c5c;
  --yellow:#f1c40f;
}
body{
  margin:0;
  font-family:Segoe UI, Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
}
.container{
  max-width:420px;
  margin:auto;
  padding:24px;
}
h1{text-align:center;font-size:20px;}
.subtitle{text-align:center;font-size:13px;color:var(--sub);margin-bottom:20px;}
.card{background:var(--card);padding:22px;border-radius:16px;}
label{display:block;margin-top:14px;font-size:13px;color:var(--sub);}
input,select{
  width:100%;padding:14px;margin-top:6px;
  border:none;border-radius:10px;
  background:var(--input);color:var(--text);font-size:16px;
}
button{
  width:100%;padding:14px;margin-top:14px;
  border:none;border-radius:12px;
  font-size:15px;cursor:pointer;
}
.salvar{background:var(--blue);color:#fff;}
.lucro{background:#2ecc71;color:#000;font-weight:600;}
.cartao{background:var(--yellow);color:#000;font-weight:600;}
.apagar{background:var(--red);color:#fff;}
.fechar{background:var(--green);color:#000;font-weight:600;}

.resumo{margin-top:16px;font-size:14px;}
.historico{margin-top:20px;font-size:13px;color:var(--sub);}
</style>
</head>

<body>
<div class="container">
  <h1>Gastos Karina</h1>
  <div class="subtitle">Controle mensal simples</div>

  <div class="card">

    <label>MÃªs de visualizaÃ§Ã£o</label>
    <input type="month" id="mesFiltro">

    <label>Valor (R$)</label>
    <input type="number" id="valor">

    <label>Parcelas (cartÃ£o)</label>
    <input type="number" id="parcelas">

    <label>Forma de pagamento</label>
    <select id="forma">
      <option value="DINHEIRO">Dinheiro</option>
      <option value="PIX">Pix</option>
      <option value="CARTÃƒO">CartÃ£o</option>
    </select>

    <label>DescriÃ§Ã£o</label>
    <input type="text" id="descricao">

    <button class="salvar" onclick="salvarGasto()">Salvar gasto</button>
    <button class="lucro" onclick="salvarLucro()">Salvar lucro</button>
    <button class="cartao" onclick="salvarCartao()">Salvar cartÃ£o parcelado</button>
    <button class="apagar" onclick="apagarUltimo()">Apagar Ãºltimo</button>

    <div class="resumo" id="resumo"></div>

    <button class="fechar" onclick="fecharMes()">Fechar mÃªs</button>

    <div class="historico" id="historico"></div>
  </div>
</div>

<script>
const ID = "karina-financeiro";
const WHATSAPP = "5511964568408"; // Karina

function mesAtual(){
  const d=new Date();
  return d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0");
}

mesFiltro.value = mesAtual();
mesFiltro.addEventListener("change", carregar);

function carregar(){
  const mes = mesFiltro.value;
  const dados = JSON.parse(localStorage.getItem(ID+"-"+mes)) || [];

  let gastos=0, lucros=0;
  let cartao=0, pix=0, dinheiro=0;

  dados.forEach(i=>{
    if(i.tipo==="gasto"){
      gastos+=i.valor;
      if(i.forma==="CARTÃƒO") cartao+=i.valor;
      if(i.forma==="PIX") pix+=i.valor;
      if(i.forma==="DINHEIRO") dinheiro+=i.valor;
    }else{
      lucros+=i.valor;
    }
  });

  resumo.innerHTML =
    `ðŸ’¸ Gastos: R$ ${gastos.toFixed(2)}<br>
     ðŸ’° Lucros: R$ ${lucros.toFixed(2)}<br>
     ðŸ“Š Resultado: R$ ${(lucros-gastos).toFixed(2)}<hr>
     ðŸ’³ CartÃ£o: R$ ${cartao.toFixed(2)}<br>
     ðŸ“± Pix: R$ ${pix.toFixed(2)}<br>
     ðŸ’µ Dinheiro: R$ ${dinheiro.toFixed(2)}`;

  historico.innerHTML = dados.map(i =>
    `â€¢ ${i.tipo.toUpperCase()} â€“ R$ ${i.valor.toFixed(2)}
     (${i.desc} â€“ ${i.forma}${i.mesRef ? " â€“ "+i.mesRef : ""})`
  ).join("<br>");
}

function salvarGasto(){
  const mes = mesFiltro.value;
  const v = parseFloat(valor.value);
  if(!v) return alert("Informe valor");

  const dados = JSON.parse(localStorage.getItem(ID+"-"+mes)) || [];
  dados.push({tipo:"gasto", valor:v, forma:forma.value, desc:descricao.value||"-"});
  localStorage.setItem(ID+"-"+mes, JSON.stringify(dados));
  limpar(); carregar();
}

function salvarLucro(){
  const mes = mesFiltro.value;
  const v = parseFloat(valor.value);
  if(!v) return alert("Informe valor");

  const dados = JSON.parse(localStorage.getItem(ID+"-"+mes)) || [];
  dados.push({tipo:"lucro", valor:v, forma:forma.value, desc:descricao.value||"-"});
  localStorage.setItem(ID+"-"+mes, JSON.stringify(dados));
  limpar(); carregar();
}

function salvarCartao(){
  const v = parseFloat(valor.value);
  const p = parseInt(parcelas.value);
  if(!v || !p) return alert("Informe valor e parcelas");

  for(let i=0;i<p;i++){
    const d = new Date(mesFiltro.value+"-01");
    d.setMonth(d.getMonth()+i);
    const mes = d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0");

    const dados = JSON.parse(localStorage.getItem(ID+"-"+mes)) || [];
    dados.push({
      tipo:"gasto",
      valor:v/p,
      forma:"CARTÃƒO",
      mesRef:mes,
      desc:`${descricao.value||"Compra"} ${i+1}/${p}`
    });
    localStorage.setItem(ID+"-"+mes, JSON.stringify(dados));
  }
  limpar(); carregar();
}

function apagarUltimo(){
  const mes = mesFiltro.value;
  const dados = JSON.parse(localStorage.getItem(ID+"-"+mes)) || [];
  if(dados.length===0) return;
  dados.pop();
  localStorage.setItem(ID+"-"+mes, JSON.stringify(dados));
  carregar();
}

function fecharMes(){
  const mes = mesFiltro.value;
  const dados = JSON.parse(localStorage.getItem(ID+"-"+mes)) || [];

  let gastos=0, lucros=0;
  dados.forEach(i => i.tipo==="gasto" ? gastos+=i.valor : lucros+=i.valor);

  const texto =
    `ðŸ“Š *Resumo financeiro â€“ Karina*%0A%0A`+
    `ðŸ“… MÃªs: ${mes}%0A`+
    `ðŸ’¸ Gastos: R$ ${gastos.toFixed(2)}%0A`+
    `ðŸ’° Lucros: R$ ${lucros.toFixed(2)}%0A`+
    `ðŸ“ˆ Resultado: R$ ${(lucros-gastos).toFixed(2)}`;

  window.open(`https://wa.me/${WHATSAPP}?text=${texto}`, "_blank");
}

function limpar(){
  valor.value=""; parcelas.value=""; descricao.value="";
}

carregar();
</script>
</body>
</html>
